# CLAUDE.md - db_architecture

**ë²„ì „**: 1.2.0 | **Context**: Windows, PowerShell

---

## í”„ë¡œì íŠ¸ ê°œìš”

GGP Poker Video Catalog í”„ë¡œì íŠ¸ì˜ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„ ë¬¸ì„œì…ë‹ˆë‹¤.

```
db_architecture/
â”œâ”€â”€ backend/              # FastAPI ë°±ì—”ë“œ
â”‚   â”œâ”€â”€ src/              # ì†ŒìŠ¤ ì½”ë“œ
â”‚   â”œâ”€â”€ tests/            # í…ŒìŠ¤íŠ¸
â”‚   â””â”€â”€ docker/           # Docker ì„¤ì •
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ lld/              # Low-Level Design ë¬¸ì„œ
â”‚   â”‚   â”œâ”€â”€ LLD_INDEX.md
â”‚   â”‚   â”œâ”€â”€ 01_DATABASE_SCHEMA.md
â”‚   â”‚   â”œâ”€â”€ 02_SYNC_SYSTEM.md
â”‚   â”‚   â”œâ”€â”€ 03_FILE_PARSER.md
â”‚   â”‚   â”œâ”€â”€ 04_DOCKER_DEPLOYMENT.md
â”‚   â”‚   â”œâ”€â”€ 05_AGENT_SYSTEM.md
â”‚   â”‚   â”œâ”€â”€ 06_BACKEND_API.md
â”‚   â”‚   â””â”€â”€ 07_CATALOG_SYSTEM.md
â”‚   â”œâ”€â”€ PRD.md
â”‚   â””â”€â”€ PRD_BLOCK_AGENT_SYSTEM.md
â””â”€â”€ CLAUDE.md
```

---

## í•µì‹¬ ê·œì¹™

| ê·œì¹™ | ë‚´ìš© |
|------|------|
| **ì–¸ì–´** | í•œê¸€ ì¶œë ¥. ê¸°ìˆ  ìš©ì–´(code, GitHub)ëŠ” ì˜ì–´ |
| **ê²½ë¡œ** | ì ˆëŒ€ ê²½ë¡œë§Œ. `D:\AI\claude01\db_architecture\...` |
| **ë¬¸ì„œ ì¶©ëŒ** | ì¶©ëŒ ì‹œ ì‚¬ìš©ìì—ê²Œ ì§ˆë¬¸ (ì„ì˜ íŒë‹¨ ê¸ˆì§€) |

---

## ì•„í‚¤í…ì²˜ ê²°ì • ì‚¬í•­

### Block Agent System ë„ì… ê¸°ì¤€

> **ì¤‘ìš”**: Block Agent Systemì€ **ì½”ë“œë² ì´ìŠ¤ê°€ 50ê°œ+ íŒŒì¼, 20K+ ë¼ì¸ ë„ë‹¬ ì‹œ** ì¬ê²€í† 
>
> í˜„ì¬ ìƒíƒœ (~20ê°œ íŒŒì¼, ~5K ë¼ì¸)ì—ì„œëŠ” **ë‹¨ìˆœ ëª¨ë†€ë¦¬ì‹ êµ¬ì¡°**ê°€ ë” íš¨ìœ¨ì .
> ë³µì¡í•œ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ ì—†ì´ë„ NAS ë™ê¸°í™”ê°€ ì˜ ë™ì‘ ì¤‘.

### ì¹´íƒˆë¡œê·¸ UI ë°©í–¥

- **í”Œë« ë¦¬ìŠ¤íŠ¸**: Netflix ìŠ¤íƒ€ì¼ ì¸ë„¤ì¼ + ì œëª© ë¦¬ìŠ¤íŠ¸
- **ìë™ ì •ì œ ì œëª©**: íŒŒì¼ëª…ì—ì„œ ê°€ë…ì„± ìˆëŠ” ì œëª© ìë™ ìƒì„±
- **í•„í„°/ê²€ìƒ‰**: í”„ë¡œì íŠ¸, ì—°ë„, ê²Œì„íƒ€ì…ìœ¼ë¡œ í•„í„°ë§

---

## ë°ì´í„°ë² ì´ìŠ¤ ì‘ì—… ì§€ì¹¨

### ë¬¸ì„œ ìˆ˜ì • ì‹œ ìš°ì„ ìˆœìœ„

| ì‘ì—… | ìˆ˜í–‰ ë°©ë²• |
|------|----------|
| **ë¬¸ì„œ ìˆ˜ì •** | ëŒ€ìƒ íŒŒì¼ì„ ì§ì ‘ Readí•˜ì—¬ ë‚´ìš© í™•ì¸ |
| **ìŠ¤í‚¤ë§ˆ ë³€ê²½** | ê¸°ì¡´ DDL íŒŒì¼ í™•ì¸ í›„ Edit ë„êµ¬ë¡œ ìˆ˜ì • |
| **ê²€ìƒ‰, íƒìƒ‰** | ì—¬ëŸ¬ ë¬¸ì„œ íƒìƒ‰ í•„ìš” ì‹œ Task ì—ì´ì „íŠ¸ í™œìš© |

### ì‹ ê·œ SQL DDL ì‘ì„±

```
1. ê¸°ì¡´ í…Œì´ë¸”ê³¼ ê´€ê³„ í™•ì¸ í›„ ëŒ€ìƒ íŒŒì¼ íŠ¹ì •
2. DDL ì¶”ê°€ ì‹œ ê¸°ì¡´ íŒŒì¼ì— Edit
3. View/Trigger ë“± ë³µì¡í•œ ê°ì²´ëŠ” ë³„ë„ ì„¹ì…˜
```

### ë¬¸ì„œí™” ìš°ì„ ìˆœìœ„

- **ì‚¬ìš©ìê°€ ìš”ì²­í•œ ë‚´ìš©**: ê°€ì¥ ë¨¼ì € ë¬¸ì„œí™”
- **ì•”ë¬µì  ë³€ê²½**: ì¤‘ìš” ë³€ê²½ì€ ê´€ë ¨ ë¬¸ì„œì— ë°˜ì˜
- **ë³€ê²½ ì´ë ¥**: ìŠ¤í‚¤ë§ˆ ë³€ê²½ì€ ë°˜ë“œì‹œ ë²„ì „ ê¸°ë¡

---

## ë¬¸ì„œ ë²„ì „ ê´€ë¦¬

### ë²„ì „ í˜•ì‹

```markdown
> **ë²„ì „**: X.Y.Z | **ê¸°ì¤€ PRD**: v5.1 | **ì‘ì„±ì¼**: YYYY-MM-DD | **ìˆ˜ì •ì¼**: YYYY-MM-DD

### ë³€ê²½ ì´ë ¥
| ë²„ì „ | ë‚ ì§œ | ë³€ê²½ ë‚´ìš© |
|------|------|----------|
| X.Y.Z | YYYY-MM-DD | ë³€ê²½ ë‚´ìš© ìš”ì•½ |
```

### ë²„ì „ ë²ˆí˜¸ ê·œì¹™

- **Major (X)**: ëŒ€ê·œëª¨ ë³€ê²½, í˜¸í™˜ì„± ê¹¨ì§€ëŠ” ë³€ê²½
- **Minor (Y)**: ê¸°ëŠ¥ ì¶”ê°€, ì„¹ì…˜ ì‹ ê·œ/ì‚­ì œ
- **Patch (Z)**: ì˜¤íƒ€ ìˆ˜ì •, ì„¤ëª… ë³´ì™„, ë¬¸ì„œ ì •ë¦¬

---

## GitHub ì´ìŠˆ ì—°ë™

### ì´ìŠˆ ì°¸ì¡° í˜•ì‹

ë¬¸ì„œ ë‚´ ì´ìŠˆ ì°¸ì¡°: `#ì´ìŠˆë²ˆí˜¸` (ì˜ˆ: #7 bracelets UNIQUE ì œì•½ì¡°ê±´)

### PR ìƒì„± í˜•ì‹

```bash
# ì´ìŠˆ ì¼ê´„ í•´ê²°
gh pr create --title "fix: resolve issues #1-15" --body "Closes #1, #2, ..."
```

---

## í˜„ì¬ êµ¬í˜„ ìƒíƒœ

| ì»´í¬ë„ŒíŠ¸ | ìƒíƒœ | ë¹„ê³  |
|----------|------|------|
| PostgreSQL 15 | âœ… ì™„ë£Œ | Docker (pokervod-db:5432) |
| NAS Sync | âœ… ì™„ë£Œ | 1,856 íŒŒì¼, 19TB |
| File Parser | âœ… ì™„ë£Œ | 7ê°œ í”„ë¡œì íŠ¸ íŒ¨í„´ |
| Backend API | âœ… ì™„ë£Œ | FastAPI 14ê°œ ì—”ë“œí¬ì¸íŠ¸ (port 9000) |
| íŒŒì¼ í•„í„° | âœ… ì™„ë£Œ | is_hidden, hidden_reason |
| ë™ê¸°í™” ê²€ìˆ˜ | âœ… ì™„ë£Œ | Issue #23 - í´ë” íŠ¸ë¦¬, Sheets ë·°ì–´ |
| Google Sheets | âš ï¸ ë¯¸ì™„ | ë¼ì´ë¸ŒëŸ¬ë¦¬ë§Œ ì„¤ì¹˜ |
| Catalog UI | âŒ ë¯¸êµ¬í˜„ | ë‹¤ìŒ ì‘ì—… |
| Block Agent | âŒ ë¯¸êµ¬í˜„ | 50+ íŒŒì¼ ë„ë‹¬ ì‹œ ì¬ê²€í†  |

---

## ğŸ”„ ë‹¤ìŒ ì„¸ì…˜ ì‹œì‘ì 

> **ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2025-12-10

### í˜„ì¬ ë¸Œëœì¹˜

```
fix/issue-23-sync-inspection (84853ff)
```

### Docker ì»¨í…Œì´ë„ˆ ìƒíƒœ

| ì„œë¹„ìŠ¤ | í¬íŠ¸ | ìƒíƒœ |
|--------|------|------|
| pokervod-db | 5432 | âœ… healthy |
| pokervod-api | **9000** | âœ… healthy |
| pokervod-frontend | 3001 | âœ… healthy |

### ì™„ë£Œëœ ì‘ì—…

- [x] Issue #23: ë™ê¸°í™” ë°ì´í„° ê²€ìˆ˜ ê¸°ëŠ¥
  - `/api/sync/tree` - NAS í´ë” íŠ¸ë¦¬ êµ¬ì¡°
  - `/api/sync/sheets/preview` - Google Sheets ë°ì´í„° ë¯¸ë¦¬ë³´ê¸°
  - `/api/sync/scheduler` - APScheduler ìƒíƒœ ì¡°íšŒ
  - `DataBrowser.tsx` - í´ë” íŠ¸ë¦¬ ë·°ì–´ ì»´í¬ë„ŒíŠ¸
  - `SheetsViewer.tsx` - Sheets ë°ì´í„° ë·°ì–´ ì»´í¬ë„ŒíŠ¸
  - `Sync.tsx` - íƒ­ ë„¤ë¹„ê²Œì´ì…˜ (status/files/sheets)

### ë¯¸ì»¤ë°‹ ë³€ê²½ì‚¬í•­

```
src/agents/blocks/parser/parser_agent.py  (ìˆ˜ì •ë¨)
tests/agents/test_parser_agent.py         (ìˆ˜ì •ë¨)
```

### ë‹¤ìŒ ìš°ì„ ìˆœìœ„ ì‘ì—…

1. **Catalog UI êµ¬í˜„** - Netflix ìŠ¤íƒ€ì¼ ë¹„ë””ì˜¤ ì¹´íƒˆë¡œê·¸
2. **Google Sheets ë™ê¸°í™” ì™„ì„±** - ì‹¤ì œ ì—°ë™ êµ¬í˜„
3. **ê²€ìƒ‰ ê¸°ëŠ¥** - MeiliSearch ë˜ëŠ” PostgreSQL Full-text

---

## ì°¸ì¡°

| ë¬¸ì„œ | ì„¤ëª… |
|------|------|
| [LLD_INDEX.md](./docs/lld/LLD_INDEX.md) | LLD ë¬¸ì„œ ì¸ë±ìŠ¤ |
| [PRD.md](./docs/PRD.md) | ì œí’ˆ ìš”êµ¬ì‚¬í•­ ë¬¸ì„œ |
| [ìƒìœ„ CLAUDE.md](../CLAUDE.md) | ëª¨ë…¸ë ˆí¬ ì „ì²´ ì§€ì¹¨ |

---

**ë¬¸ì„œ ë²„ì „**: 1.2.0
**ì‘ì„±ì¼**: 2025-12-09
**ìˆ˜ì •ì¼**: 2025-12-10

### ë³€ê²½ ì´ë ¥

| ë²„ì „ | ë‚ ì§œ | ë³€ê²½ ë‚´ìš© |
|------|------|----------|
| 1.2.0 | 2025-12-10 | ë‹¤ìŒ ì„¸ì…˜ ì‹œì‘ì  ì„¹ì…˜ ì¶”ê°€, Issue #23 ì™„ë£Œ ë°˜ì˜, API í¬íŠ¸ 9000 ë³€ê²½ |
| 1.1.0 | 2025-12-09 | Block Agent ë„ì… ê¸°ì¤€ ì¶”ê°€, í˜„ì¬ êµ¬í˜„ ìƒíƒœ ì„¹ì…˜ ì¶”ê°€, ì¹´íƒˆë¡œê·¸ UI ë°©í–¥ ì¶”ê°€ |
| 1.0.0 | 2025-12-09 | ì´ˆê¸° ë²„ì „ |
